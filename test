import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Assuming df is your DataFrame after reading from 'Book1.xlsx' and the first column is renamed to 'Client'

# Function to format the y-axis as percentages
def percentage_formatter(x, pos):
    return '{:.0f}%'.format(x)

# Creating the plots with y-axis formatted as percentages and without grid lines
fig, axes = plt.subplots(nrows=2, ncols=4, figsize=(20, 10), sharex=True, sharey=True)
fig.subplots_adjust(hspace=0.5, wspace=0.5)

# Plotting data for each client
for i, (client, data) in enumerate(df.groupby('Client')):
    row = i // 4
    col = i % 4
    ax = axes[row, col]
    sns.lineplot(x='Country', y='% Spend', data=data, ax=ax, marker='o')
    ax.set_title(f'Client {client}')
    ax.tick_params(axis='x', rotation=45)
    ax.xaxis.grid(False)  # Disable x-axis grid lines
    ax.yaxis.grid(False)  # Disable y-axis grid lines
    ax.yaxis.set_major_formatter(plt.FuncFormatter(percentage_formatter))  # Format y-axis

# Adjust the layout
plt.tight_layout()

# Save the figure
plt.savefig('/mnt/data/clients_spend_by_country_percent_format.png')
plt.close()  # Close the plot to prevent it from displaying in the output
